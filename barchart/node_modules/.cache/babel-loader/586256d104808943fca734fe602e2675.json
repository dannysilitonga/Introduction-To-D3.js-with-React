{"ast":null,"code":"import * as d3 from 'd3';\nconst MARGIN = {\n  TOP: 10,\n  BOTTOM: 50,\n  LEFT: 70,\n  RIGHT: 10\n};\nconst WIDTH = 800 - MARGIN.LEFT - MARGIN.RIGHT;\nconst HEIGHT = 500 - MARGIN.TOP - MARGIN.BOTTOM;\nexport default class D3Chart {\n  constructor(element) {\n    const vis = this;\n    vis.svg = d3.select(element).append(\"svg\").attr(\"width\", WIDTH + MARGIN.LEFT + MARGIN.RIGHT).attr(\"height\", HEIGHT + MARGIN.TOP + MARGIN.BOTTOM).append(\"g\").attr(\"transform\", \"translate(\".concat(MARGIN.LEFT, \", \").concat(MARGIN.TOP, \")\"));\n    vis.xLabel = vis.svg.append(\"text\").attr(\"x\", WIDTH / 2).attr(\"y\", HEIGHT + 50).attr(\"text-anchor\", \"middle\");\n    vis.svg.append(\"text\").attr(\"x\", -(HEIGHT / 2)).attr(\"y\", -50).attr(\"text-anchor\", \"middle\").text(\"Height in cm\").attr(\"transform\", \"rotate(-90)\");\n    vis.xAxisGroup = vis.svg.append(\"g\").attr(\"transform\", \"translate(0, \".concat(HEIGHT, \")\"));\n    vis.yAxisGroup = vis.svg.append(\"g\");\n    Promise.all([d3.json(\"https://sentimentviz-default-rtdb.firebaseio.com/top_videos_24_15.json\"), d3.json(\"https://udemy-react-d3.firebaseio.com/tallest_women.json\")]).then(datasets => {\n      vis.menData = datasets[0];\n      vis.womenData = datasets[1];\n      vis.update(\"men\");\n    });\n  }\n  update(gender) {\n    const vis = this;\n    vis.data = gender == \"men\" ? vis.menData : vis.womenData;\n    vis.xLabel.text(\"The world's tallest \".concat(gender));\n    const y = d3.scaleLinear().domain([d3.min(vis.data, d => d.height) * 0.95, d3.max(vis.data, d => d.height)]).range([HEIGHT, 0]);\n    const x = d3.scaleBand().domain(vis.data.map(d => d.name)).range([0, WIDTH]).padding(0.4);\n    const xAxisCall = d3.axisBottom(x);\n    vis.xAxisGroup.transition().duration(500).call(xAxisCall);\n    const yAxisCall = d3.axisLeft(y);\n    vis.yAxisGroup.transition().duration(500).call(yAxisCall);\n\n    // DATA JOIN\n    const rects = vis.svg.selectAll(\"rect\").data(vis.data);\n\n    // EXIT\n    rects.exit().transition().duration(500).attr(\"height\", 0).attr(\"y\", HEIGHT).remove();\n\n    // UPDATE\n    rects.transition().duration(500).attr(\"x\", d => x(d.name)).attr(\"y\", d => y(d.height)).attr(\"width\", x.bandwidth).attr(\"height\", d => HEIGHT - y(d.height));\n\n    // ENTER\n    rects.enter().append(\"rect\").attr(\"x\", d => x(d.name)).attr(\"width\", x.bandwidth).attr(\"fill\", \"grey\").attr(\"y\", HEIGHT).transition().duration(500).attr(\"height\", d => HEIGHT - y(d.height)).attr(\"y\", d => y(d.height));\n    console.log(rects);\n  }\n}","map":{"version":3,"names":["d3","MARGIN","TOP","BOTTOM","LEFT","RIGHT","WIDTH","HEIGHT","D3Chart","constructor","element","vis","svg","select","append","attr","concat","xLabel","text","xAxisGroup","yAxisGroup","Promise","all","json","then","datasets","menData","womenData","update","gender","data","y","scaleLinear","domain","min","d","height","max","range","x","scaleBand","map","name","padding","xAxisCall","axisBottom","transition","duration","call","yAxisCall","axisLeft","rects","selectAll","exit","remove","bandwidth","enter","console","log"],"sources":["/workspace/Introduction-To-D3.js-with-React/barchart/src/D3Chart.js"],"sourcesContent":["import * as d3 from 'd3'\n\nconst MARGIN = { TOP: 10, BOTTOM: 50, LEFT: 70, RIGHT: 10 }\nconst WIDTH = 800 - MARGIN.LEFT - MARGIN.RIGHT;\nconst HEIGHT = 500 - MARGIN.TOP - MARGIN.BOTTOM;\n\nexport default class D3Chart {\n\tconstructor(element) {\n\t\tconst vis = this\n\n\t\tvis.svg = d3.select(element)\n\t\t\t.append(\"svg\")\n\t\t\t\t.attr(\"width\", WIDTH + MARGIN.LEFT + MARGIN.RIGHT)\n\t\t\t\t.attr(\"height\", HEIGHT + MARGIN.TOP + MARGIN.BOTTOM)\n\t\t\t.append(\"g\")\n\t\t\t\t.attr(\"transform\", `translate(${MARGIN.LEFT}, ${MARGIN.TOP})`)\n\n\t\tvis.xLabel = vis.svg.append(\"text\")\n\t\t\t.attr(\"x\", WIDTH / 2)\n\t\t\t.attr(\"y\", HEIGHT + 50)\n\t\t\t.attr(\"text-anchor\", \"middle\")\n\n\t\tvis.svg.append(\"text\")\n\t\t\t.attr(\"x\", -(HEIGHT / 2))\n\t\t\t.attr(\"y\", -50)\n\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t.text(\"Height in cm\")\n\t\t\t.attr(\"transform\", \"rotate(-90)\")\n\n\t\tvis.xAxisGroup = vis.svg.append(\"g\")\n\t\t\t.attr(\"transform\", `translate(0, ${HEIGHT})`)\n\n\t\tvis.yAxisGroup = vis.svg.append(\"g\")\n\n\t\tPromise.all([\n\t\t\td3.json(\"https://sentimentviz-default-rtdb.firebaseio.com/top_videos_24_15.json\"),\n\t\t\td3.json(\"https://udemy-react-d3.firebaseio.com/tallest_women.json\")\n\t\t]).then((datasets) => {\n\t\t\tvis.menData = datasets[0]\n\t\t\tvis.womenData = datasets[1]\n\t\t\tvis.update(\"men\")\n\t\t})\n\t}\n\n\tupdate(gender) {\n\t\tconst vis = this\n\n\t\tvis.data = (gender == \"men\") ? vis.menData : vis.womenData;\n\t\tvis.xLabel.text(`The world's tallest ${gender}`)\n\n\t\tconst y = d3.scaleLinear()\n\t\t\t.domain([\n\t\t\t\td3.min(vis.data, d => d.height) * 0.95, \n\t\t\t\td3.max(vis.data, d =>  d.height)\n\t\t\t])\n\t\t\t.range([HEIGHT, 0])\n\n\t\tconst x = d3.scaleBand()\n\t\t\t.domain(vis.data.map(d => d.name))\n\t\t\t.range([0, WIDTH])\n\t\t\t.padding(0.4)\n\n\t\tconst xAxisCall = d3.axisBottom(x)\n\t\tvis.xAxisGroup.transition().duration(500).call(xAxisCall)\n\n\t\tconst yAxisCall = d3.axisLeft(y)\n\t\tvis.yAxisGroup.transition().duration(500).call(yAxisCall)\n\n\t\t// DATA JOIN\n\t\tconst rects = vis.svg.selectAll(\"rect\")\n\t\t\t.data(vis.data)\n\n\t\t// EXIT\n\t\trects.exit()\n\t\t\t.transition().duration(500)\n\t\t\t\t.attr(\"height\", 0)\n\t\t\t\t.attr(\"y\", HEIGHT)\n\t\t\t\t.remove()\n\n\t\t// UPDATE\n\t\trects.transition().duration(500)\n\t\t\t.attr(\"x\", d => x(d.name))\n\t\t\t.attr(\"y\", d => y(d.height))\n\t\t\t.attr(\"width\", x.bandwidth)\n\t\t\t.attr(\"height\", d => HEIGHT - y(d.height))\n\n\t\t// ENTER\n\t\trects.enter().append(\"rect\")\n\t\t\t.attr(\"x\", d => x(d.name))\n\t\t\t.attr(\"width\", x.bandwidth)\n\t\t\t.attr(\"fill\", \"grey\")\n\t\t\t.attr(\"y\", HEIGHT)\n\t\t\t.transition().duration(500)\n\t\t\t\t.attr(\"height\", d => HEIGHT - y(d.height))\n\t\t\t\t.attr(\"y\", d => y(d.height))\n\n\t\t\tconsole.log(rects)\n\t}\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}